
<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>IBAN DOÄžRULAMA</title>

<style>
*, *::before, *::after { box-sizing: border-box; }
html, body { height: 100%; margin:0; }

:root{
  --bg:#eef2f7;
  --card-bg:#ffffffcc;
  --text:#111;
  --border:rgba(0,0,0,.15);

  --logo-color:#111;
  --logo-sub:#006CFF;

  --footer-circle:#006CFF;
  --footer-text:#111;
  --footer-sub:#006CFF;

  --success:#7CCF90;
  --error:rgba(255,0,0,.26);

  --button:linear-gradient(135deg,#006CFF,#4A2CFF);
  --button-hover:linear-gradient(135deg,#0052e6,#3a24d9);

  --switch-bg:#bbb;
  --switch-knob:#fff;

  --switch-sun:#f7c235;
  --switch-moon:#fff;
}

body.dark{
  --bg:#07090d;
  --card-bg:#1e1e1ecc;
  --text:#fff;

  --logo-color:#fff;
  --logo-sub:#66B3FF;

  --footer-circle:#66B3FF;
  --footer-text:#fff;
  --footer-sub:#66B3FF;

  --switch-bg:#444;
  --switch-knob:#fff;

  --switch-sun:#444;
  --switch-moon:#fff;
}

body{
  font-family:"Segoe UI", Arial, sans-serif;
  background:var(--bg);
  color:var(--text);
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
  transition:.3s;
}

@keyframes shake {
  0% { transform: translateX(0); }
  20% { transform: translateX(-4px); }
  40% { transform: translateX(4px); }
  60% { transform: translateX(-4px); }
  80% { transform: translateX(4px); }
  100% { transform: translateX(0); }
}
.input-error {
  border-color: red !important;
  animation: shake .35s ease;
}

#rightTop{
  position:fixed; top:25px; right:40px;
}

#rightTop .sun-fixed,
#rightTop .moon-fixed {
  position: absolute;
  width: 18px;
  height: 18px;
  top: 50%;
  transform: translateY(-50%);
  transition: opacity .25s;
}

#rightTop .sun-fixed { 
  left: -28px; 
  opacity: 1; 
  stroke: var(--switch-sun); 
  fill: none;
}

#rightTop .moon-fixed { 
  left: -28px; 
  opacity: 0; 
  stroke: var(--switch-moon); 
  fill: none;
}

body.dark #rightTop .sun-fixed { opacity: 0; }
body.dark #rightTop .moon-fixed { opacity: 1; }

.switch { width: 54px; height: 30px; position: relative; display:inline-block;}
.switch input { display:none; }
.slider {
  position:absolute; inset:0;
  background:var(--switch-bg);
  border-radius:30px;
  transition:.35s;
  cursor:pointer;
}
.switch-handle {
  position:absolute; width:26px; height:26px;
  background:var(--switch-knob);
  border-radius:50%;
  top:2px; left:2px;
  transition:.35s cubic-bezier(.4,0,.2,1);
  box-shadow:0 2px 6px rgba(0,0,0,.25);
}
input:checked + .slider { background:#34C759; }
input:checked + .slider .switch-handle { transform:translateX(24px); }

#logoBox{
  position:fixed;
  top:25px; left:25px;
  cursor:pointer;
  transition:.2s;
}
#logoBox:hover{ transform:scale(1.05); }

.logo-main{ fill:var(--logo-color); }
.logo-sub{ fill:var(--logo-sub); }

.kutu{
  width:min(650px,92vw);
  background:var(--card-bg);
  border:1px solid var(--border);
  border-radius:18px;
  padding:35px;
  margin-top:40px;
  backdrop-filter:blur(18px);
}

.input-wrap{ position:relative; width:100%; }

#iban{
  width:100%; height:52px;
  padding:0 56px 0 18px;
  border:1px solid var(--border);
  border-radius:12px;
  font-size:18px;
  background:#fff8;
  color:var(--text);
}
body.dark #iban{ background:#333a; color:#fff; }

.paste-btn{
  position:absolute;
  right:12px; top:50%;
  transform:translateY(-50%);
  font-size:22px; cursor:pointer;
}

button.action{
  width:100%; height:58px;
  border:none;
  margin-top:25px;
  background:var(--button);
  color:#fff;
  border-radius:16px;
  font-size:20px;
  font-weight:700;
}
button.action:hover{
  transform:scale(1.03);
  background:var(--button-hover);
}

.sonuc{
  display:none;
  margin-top:20px;
  padding:16px 22px;
  border-radius:12px;
  font-size:20px;
  font-weight:600;
  color:white;
}
.ok{ background:var(--success); }
.err{ background:var(--error); }

.result-flex{
  display:flex;
  justify-content:space-between;
}

#altFooter{
  position:fixed; bottom:25px; right:25px;
}

#footerLogo{
  display:flex; align-items:center;
  gap:10px;
}

.footer-circle{
  fill:var(--footer-circle);
}

.footer-name{ font-size:15px; font-weight:700; color:var(--footer-text); }
.footer-mail{ font-size:12px; font-weight:600; color:var(--footer-sub); }

/* METÄ°N HALÄ°NDE Ä°STATÄ°STÄ°K */
#istatistik {
  text-align:center;
  font-weight:600;
  margin-bottom:12px;
  opacity:.9;
}
</style>
</head>

<body>

<!-- LOGO -->
<div id="logoBox" onclick="location.reload()">
  <svg width="230" height="60" viewBox="0 0 330 90">
    <circle cx="45" cy="45" r="28" class="logo-sub"></circle>
    <path d="M34 45l10 10 18-24"
      stroke="white" stroke-width="7"
      fill="none" stroke-linecap="round" stroke-linejoin="round"></path>

    <text x="95" y="43" font-size="36" font-weight="700" class="logo-main">IBAN</text>
    <text x="95" y="72" font-size="24" font-weight="700" class="logo-sub">DOÄžRULAMA</text>
  </svg>
</div>

<!-- TEMA SWITCH -->
<div id="rightTop">
  <svg class="sun-fixed" viewBox="0 0 24 24">
    <circle cx="12" cy="12" r="4"></circle>
    <line x1="12" y1="1" x2="12" y2="4"></line>
    <line x1="12" y1="20" x2="12" y2="23"></line>
    <line x1="1" y1="12" x2="4" y2="12"></line>
    <line x1="20" y1="12" x2="23" y2="12"></line>
    <line x1="4" y1="4" x2="6" y2="6"></line>
    <line x1="18" y1="18" x2="20" y2="20"></line>
    <line x1="4" y1="20" x2="6" y2="18"></line>
    <line x1="18" y1="6" x2="20" y2="4"></line>
  </svg>

  <svg class="moon-fixed" viewBox="0 0 24 24">
    <path d="M21 12.79A9 9 0 0 1 12.21 3 7 7 0 1 0 21 12.79z"></path>
  </svg>

  <label class="switch">
    <input type="checkbox" id="themeToggle">
    <span class="slider"><div class="switch-handle"></div></span>
  </label>
</div>

<!-- ANA KART -->
<div class="kutu" id="mainCard">

  <!-- METÄ°N HALÄ°NDE AÃ‡IKLAMA + SAYI -->
  <div id="istatistik">Bir IBAN numarasÄ±nÄ± doÄŸrulayÄ±n, bugÃ¼n 0 adet doÄŸrulama yapÄ±ldÄ±.</div>

  <div class="input-wrap">
    <input id="iban" placeholder="TR25 0000 0000 0000 0000 0000 25">
    <span class="paste-btn" onclick="pasteIBAN()">ðŸ“‹</span>
  </div>

  <button class="action" onclick="ibanKontrol()">DOÄžRULA â€£</button>

  <div id="sonuc" class="sonuc"></div>
</div>

<!-- FOOTER -->
<div id="altFooter">
  <div id="footerLogo">
    <svg width="46" height="46" viewBox="0 0 80 80">
      <circle cx="40" cy="40" r="28" class="footer-circle"></circle>
      <text x="40" y="48" text-anchor="middle"
        font-family="Segoe UI" font-size="28" font-weight="700" fill="white">ET</text>
    </svg>
    <div>
      <div class="footer-name">ETÃœRK</div>
      <div class="footer-mail">e.turk@palen.com.tr</div>
    </div>
  </div>
</div>

<script>
themeToggle.onchange = () =>
  document.body.classList.toggle("dark", themeToggle.checked);

iban.addEventListener("input", e=>{
  // GiriÅŸi normalize et, baÅŸÄ±na TRâ€™yi otomatik getir ve 4â€™lÃ¼ gruplandÄ±r
  const cleaned = e.target.value.toUpperCase().replace(/[^0-9A-Z]/g,"");
  const country = cleaned.slice(0,2);
  const rest = (country === "TR") ? cleaned.slice(2) : cleaned;
  const raw = "TR" + rest;

  let o="";
  for(let i=0;i<raw.length;i++){
    if(i>0 && i%4===0) o+=" ";
    o+=raw[i];
  }
  e.target.value=o;
});

async function pasteIBAN(){
  try{
    let t=await navigator.clipboard.readText();
    t=t.replace(/\s+/g,"").toUpperCase();
    // Panodan yapÄ±ÅŸtÄ±rmada da TRâ€™yi garanti et
    const country = t.slice(0,2);
    const rest = (country === "TR") ? t.slice(2) : t;
    t = "TR" + rest;

    iban.value=t;
    iban.dispatchEvent(new Event("input"));
  }catch{}
}

const bankalar={
"001":"Merkez BankasÄ±","010":"Ziraat BankasÄ±","012":"Halkbank","015":"VakÄ±fbank",
"014":"TSKB","016":"Eximbank","017":"TÃ¼rkiye KalkÄ±nma BankasÄ±",
"029":"BirleÅŸik Fon BankasÄ±","032":"TEB","034":"Aktif YatÄ±rÄ±m BankasÄ±",
"046":"Akbank","048":"HSBC","058":"SÄ±nai YatÄ±rÄ±m BankasÄ±","059":"Åžekerbank",
"062":"Garanti BBVA","064":"Ä°ÅŸ BankasÄ±","067":"YapÄ± Kredi",
"134":"Denizbank A.Åž.","091":"Arap TÃ¼rk BankasÄ±","092":"Citibank","099":"ING",
"103":"Fiba Bank","106":"Portigon AG","107":"BNP-Ak-Dresdner","108":"Turkland Bank",
"109":"Tekstil BankasÄ±","111":"Finansbank","115":"Deutsche Bank",
"125":"Burganbank","133":"ING Bank","135":"Anadolubank","157":"EnPara",
"203":"Albaraka TÃ¼rk","205":"Kuveyt TÃ¼rk","206":"TÃ¼rkiye Finans",
"208":"Asya KatÄ±lÄ±m","210":"VakÄ±f KatÄ±lÄ±m","223":"Albaraka TÃ¼rk KatÄ±lÄ±m"
};

function mod97(i){
  const r=i.slice(4)+i.slice(0,4);
  const c=r.replace(/[A-Z]/g,ch=>ch.charCodeAt(0)-55);
  let m=0;
  for(let i=0;i<c.length;i++) m=(m*10+Number(c[i]))%97;
  return m===1;
}

/* GÃœNLÃœK DOÄžRULAMA SAYACI */
const LS_KEY="ibanDailyStats";

function todayStr(){
  const d=new Date();
  return d.toISOString().slice(0,10); // YYYY-MM-DD
}

function loadStats(){
  try{
    const j=localStorage.getItem(LS_KEY);
    if(!j) return {date:todayStr(), count:0};

    const data=JSON.parse(j);

    if(data.date !== todayStr())
      return {date:todayStr(), count:0};

    return data;
  }catch{ return {date:todayStr(), count:0}; }
}

function saveStats(obj){
  localStorage.setItem(LS_KEY, JSON.stringify(obj));
}

function updateIstatistik(){
  const st=loadStats();
  document.getElementById("istatistik").textContent =
    `Bir IBAN numarasÄ±nÄ± doÄŸrulayÄ±n, bugÃ¼n ${st.count} adet doÄŸrulama yapÄ±ldÄ±.`;
}

function incrementValidCounter(){
  const st=loadStats();
  st.count++;
  saveStats(st);
  updateIstatistik();
}

document.addEventListener("DOMContentLoaded", updateIstatistik);

function ibanKontrol(){
  const v=iban.value.replace(/\s+/g,"");
  const s=document.getElementById("sonuc");

  if(!v.startsWith("TR") || v.length!==26)
    return hata("IBAN GEÃ‡ERSÄ°Z!");
  if(!mod97(v))
    return hata("IBAN GEÃ‡ERSÄ°Z!");

  // âœ” yalnÄ±zca GEÃ‡ERLÄ° OLUNCA sayaÃ§ artÄ±yor
  incrementValidCounter();

  const kod=v.slice(6,9);

  s.className="sonuc ok";
  s.style.display="block";
  s.innerHTML = `
    <div class="result-flex">
      <div>âœ” IBAN GEÃ‡ERLÄ°</div>
      <div>${bankalar[kod] ?? ""}</div>
    </div>`;
}

function hata(msg){
  const s=document.getElementById("sonuc");
  const card=document.getElementById("mainCard");

  s.className="sonuc err";
  s.style.display="block";
  s.textContent=msg;

  iban.classList.add("input-error");
  setTimeout(()=> iban.classList.remove("input-error"), 500);

  card.classList.add("snake");
  setTimeout(()=> card.classList.remove("snake"),650);
}
</script>
</body>
</html>
